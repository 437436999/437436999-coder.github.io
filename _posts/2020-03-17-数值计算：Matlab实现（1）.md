---
layout: post
title: 数值计算：Matlab实现（1）
date: 2020-03-17
author: Max.C
header-img: 'assets/img/pro38.jpg'
catalog: true
tags: 数值计算 Matlab
---

## 一、多项式计算

### 多项式创建

在Matlab中，n次多项式用一个n+1项的行向量表示，系数按照降幂排序。

例如，三元素向量

```matlab
p = [4 2 3];
```

表示多项式$p(x)=4x^2+2x+3$

### 多项式计算

可以使用 `polyval` 函数根据特定值计算多项式。

例如使用 `polyval` 计算 p(3)。

```matlab
polyval(p,3)
ans =

    45
```

也可以使用 `polyvalm` 以矩阵方式计算多项式。也就是说变量x视为方阵X：

$p(x)=4X^2+2X+3I$

其中，`X` 是方阵，`I` 是单位矩阵。

```matlab
X = [2 4 5; -1 0 3; 7 1 5];
polyvalm(p,X)
ans =

   147    60   198
    74    -1    46
   206   134   265
```

我们用Horner方法自己编写一个计算多项式的函数：

```matlab
function [ ans ] = horner( arr, x )
%输入行向量arr，变量x，求多项式结果p(x)
count = length(arr);
ans = arr(1);
for i=2:count
    ans = ans*x +arr(i);
end
end
```

执行，得到结果和polyval相同：

```matlab
>> polyval(p,3)

ans =

    45

>> horner(p,3)

ans =

    45
```



## 二、二次求根

已知二次根式$ax^2+bx+c=0$，求根公式为$(-b\pm\sqrt{b^2-4ac})/(2a)$，公式可化为$(-2c)/(b\pm \sqrt{b^2-4ac})$。

![](../assets/post_img/2020-03-09/16.png)

当$|b|≈\sqrt{b^2-4ac}$时，上述式子的分子或分母会变得极小，导致结果造成精度损失，所以，在进行运算时要选择计算相应公式，**以减小误差**：

- 当b>0，选择（1）的x2和（2）的x1；
- 当b<0，选择（1）的x1和（2）的x2；

同样，我们自己编写一个函数进行计算：

```matlab
function [ x1 x2 ] = FindTheRoot( p )
%输入p = [a b c],求ax^2+bx+c=0的根x1,x2
a = p(1);
b = p(2);
c = p(3);
del = b^2-4*a*c;
x1 = NaN;
x2 = NaN;
if a==0	%一元一次方程
    x1=-c/b;
    x2=-c/b;
    return
end
if del < 0	%根不存在
    return 
end
if b>0 %大于0
    x1 = (-b+sqrt(del))/(2*a);
    x2 = (-2*c)/(b+sqrt(del));

else 	%小于0
    x1 = (-2*c)/(b-sqrt(del));
    x2 = (-b-sqrt(del))/(2*a);
end

return
end
```



## 三、不动点迭代