---
layout: post
title: 快速幂取模
date: 2020-03-17
author: Max.C
header-img: 'assets/img/pro37.jpg'
catalog: true
tags: 算法
---

## 一、求幂算法

给定整数x、y，求$x^y$称为求幂运算，最朴素的求法为：

```cpp
long ans = 1;
for(int i = 0; i<y ;i++)
	ans *= x;
```

这一求法十分直观，但一共需要进行y次乘法，运算复杂度为O(y)；我们将y用二进制表示，看看能否减少乘法运算的次数。

## 二、快速幂

如果想求$x^y$，若y为偶数，则$x^y = (x^{y/2})^2$；如果y是奇数，$x^y =x ·(x^{y/2})^2$。

将这一过程递归下去，那我们可以仅进行${log(y)}$次乘方运算完成幂运算：

```cpp
int FastPower(int x,int y){
		long ans = 1;
		while(y){
				if(y&1){
						ans *= x;
				}
				x *= x;
				y = y>>1;
		}
}
```

下面给出一个例子：$x = 3,y = 25 = 11001$

| 第i位 | ans  | x *= x    |
| ----- | ---- | ---- |
|   1    |   $3$  |   $3^2$   |
|   0    |    $3$  |   $3^4$   |
|   0    |    $3$  |   $3^8$   |
|   1    |    $3·3^8$  |   $3^{16}$   |
|   1    |  $3·3^8·3^{16}$  |   $3^{32}$   |

这就称为快速幂算法，那么接下来可以正式介绍快速幂取模运算了。

## 三、快速幂取模

快速幂取模，即给定整数x、y，N，求$x^ymodN$的运算。如果我们直接求出$x^y$再进行求模运算，很大可能会发生溢出，从而导致结果出错。

快速幂取模的思路来自：$ab\ modN \equiv (amodN)(bmodN)modN$

取a=b，则有$a^k\ modN \equiv (amodN)^kmodN$

则我们在进行快速幂的每一步运算之后，都可以加一次取模运算，这样得到的结果依然正确：

```cpp
int FastPowerMod(int x,int y，int N){
		long ans = 1;
		while(y){
				if(y&1){
						ans = x*ans %N;
				}
				x  = x*x %N;
				y = y>>1;
		}
}
```

同样给出一个例子：

![](/assets/post_img/2020-03-09/15.png)

python实现如下：

```python
x = int(input())
y = int(input())
N = int(input())
ans = 1
while y:
	if y&1:
		ans = x*ans %N;
	x  = x*x %N;
	y = y>>1;
```